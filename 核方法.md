##### 一维核光滑方法

我们已经导出过$k-$ 最近邻平均  $\hat f(x) = Ave(y_i |x_i \in N_k(x))$ 作为回归函数$E(Y|X=x)$ 的估计

在这里，$N_k(x)$ 是平方距离最邻近x的k个点的集合

在这里我们放宽条件期望的定义，并且在目标点的邻域上计算平均值

在连续性很不好的情况下，这种平均是不行的。给出一个例子，可以使用$Nadaraya-Watson$ 的核加权平均

$$\hat f(x_0) = \frac{\sum_{i=1}^N  K_{\lambda}(x_0,x_i)y_i}{\sum_{i=1}^N K_{\lambda}(x_0,x_i)}$$ 

在这里$K_{\lambda}$ 是Epanechnikov二次核  $K_{\lambda}(x_0,x) = D(\frac{| x-x_0|}{\lambda})$ 

* 必须要确定光滑参数$\lambda$ ，它们的确定局部邻域的宽度。较大的$\lambda$ 意味着较低的方差，但是较高的偏差

* 度量窗口的宽度[常量$h_{\lambda} (x)]$ 趋向于保持估计的偏差为常数，但是方差却反比于局部密度。最近邻窗口宽度表现出相反的性质：方差为常数

* 当$x_i$ 上有结的时候，最近邻就会出现问题。使用大多数光滑技术，我们可以用如下的方法简单地归约数据集合：对$X$ 结点值上的$y_i$ 取平均值，并且用附加的权$w_i$ 补充$x_i$ 的唯一值上的这些新观测

* 边界问题：度量邻域趋向于在边界上包含较少的店，而且最近邻域变得较宽。

* 紧致核 $D(t) = \begin{cases} （1-|t|^3 )^3  & \text{如果} |t| <1 \\   0  &  \text{其他} \end{cases}$ 

  这种函数在顶部比较平坦，在其支持集的边界上是可微的。  

  局部加权回归在每个目标点$x_0$ 解一个单独的加权最小二乘方问题

  $$\min\limits_{\alpha(x_0),\beta(x_0)} \sum\limits_{i=1}^N K_{\lambda}(x_0,x_i)[y_i-\alpha(x_0)-\beta(x_0)x_i]$$

  其估计则是$\hat f(x_0)=\hat \alpha(x_0) + \hat \beta(x_0) x_0$ 尽管用整个线性模型来拟合该区间的数据，但是只使用它计算在单个点$x_0$ 上的拟合

  定义向量值函数$b(x)^T=(1,x)$ ，设$\mathbf{B}$ 是$N \times 2$ 回归矩阵，第i行为$b(x_i)^T$ ，而$\mathbf{W}(x_0)$ 是$N\times N$ 对角矩阵，第$i$ 个对角线元素为$K_{\lambda}(x_0,x_i)$ ，则有：

  $$\begin{align} \hat f(x_0) &= b(x_0)^T (B^T W(x_0)B)^{-1} B^T W(x_0)y\\ &=\sum\limits_{i=1}^N l_i(x_0) y_i \end{align}$$

  使用局部回归线性性质和真实函数$f$ 在$x_0$ 附近的级数展开，考虑$E\hat f(x_0)$ 的如下展开式：

  $$E\hat f(x_0) = f(x_0) \sum\limits_{i=1}^N l_i(x_0) +f'(x_0) \sum\limits_{i=1}^N (x_i-x_0) l_i(x_0) + \frac{f''(x_0)}{2} \sum\limits_{i=1}^N (x_i-x_0)^2 l_i(x_0) +R$$ 

  这里的偏差只是依赖于$f$ 的展开式中的二次或者是更高次项

  任意$d$ 次局部多项式拟合：

  $$\min \limits_{\alpha(x_0) , \beta_j(x_0),j=1,…,d} \sum\limits_{i=1} ^N  K_{\lambda} (x_0,x_i) \biggl[ y_i-\alpha(x_0)-\sum\limits_{j=1}^d \beta_j(x_0)x_i^j  \biggr]^2 $$ 

  维数灾难的表象之一就是在靠近边界的点所占的比例随着维数的增长到1.直接修改核，以适应二维边界很棘手，特别是对于不规则的边界。局部的多项式回归无缝地将边界调整到任意维上的期望阶

  ​

  如果整个样本的规模不随着$p$ 指数增长，就不可能在维增长的同时维持局部性和邻域中的样本大小相当。


